<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Session 08: Basic App Porting | Unikraft Summer of Code 2021</title><meta property="og:title" content="Session 08: Basic App Porting"><meta property="og:description" content="Reminders Configuring, Building and Running Unikraft At this stage, you should be familiar with the steps of configuring, building and running any application within Unikraft and know the main parts of the architecture. Below you can see a list of the commands you have used so far.
   Command Description     kraft list Get a list of all components that are available for use with kraft   kraft up -t <appname> <your_appname> Download, configure and build existing components into unikernel images   kraft run Run resulting unikernel image   kraft init -t <appname> Initialize the application   kraft configure Configure platform and architecture (interactive)   kraft configure -p <plat> -m <arch> Configure platform and architecture (non-interactive)   kraft build Build the application   kraft clean Clean the application   kraft clean -p Clean the application, fully remove the build/ folder   make clean Clean the application   make properclean Clean the application, fully remove the build/ folder   make distclean Clean the application, also remove ."><meta property="og:type" content="article"><meta property="og:url" content="/docs/sessions/08-basic-app-porting/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2021-08-31T20:44:43+02:00"><meta property="og:site_name" content="Unikraft Summer of Code 2021"><meta itemprop=name content="Session 08: Basic App Porting"><meta itemprop=description content="Reminders Configuring, Building and Running Unikraft At this stage, you should be familiar with the steps of configuring, building and running any application within Unikraft and know the main parts of the architecture. Below you can see a list of the commands you have used so far.
   Command Description     kraft list Get a list of all components that are available for use with kraft   kraft up -t <appname> <your_appname> Download, configure and build existing components into unikernel images   kraft run Run resulting unikernel image   kraft init -t <appname> Initialize the application   kraft configure Configure platform and architecture (interactive)   kraft configure -p <plat> -m <arch> Configure platform and architecture (non-interactive)   kraft build Build the application   kraft clean Clean the application   kraft clean -p Clean the application, fully remove the build/ folder   make clean Clean the application   make properclean Clean the application, fully remove the build/ folder   make distclean Clean the application, also remove ."><meta itemprop=dateModified content="2021-08-31T20:44:43+02:00"><meta itemprop=wordCount content="6217"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Session 08: Basic App Porting"><meta name=twitter:description content="Reminders Configuring, Building and Running Unikraft At this stage, you should be familiar with the steps of configuring, building and running any application within Unikraft and know the main parts of the architecture. Below you can see a list of the commands you have used so far.
   Command Description     kraft list Get a list of all components that are available for use with kraft   kraft up -t <appname> <your_appname> Download, configure and build existing components into unikernel images   kraft run Run resulting unikernel image   kraft init -t <appname> Initialize the application   kraft configure Configure platform and architecture (interactive)   kraft configure -p <plat> -m <arch> Configure platform and architecture (non-interactive)   kraft build Build the application   kraft clean Clean the application   kraft clean -p Clean the application, fully remove the build/ folder   make clean Clean the application   make properclean Clean the application, fully remove the build/ folder   make distclean Clean the application, also remove ."><link rel=preload href=/scss/main.min.1858cefeac68bf8654b05bceedf9634026955a53eb72683390eb36eb9c7a0dfc.css as=style><link href=/scss/main.min.1858cefeac68bf8654b05bceedf9634026955a53eb72683390eb36eb9c7a0dfc.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Unikraft Summer of Code 2021</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Workshop</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center d-lg-none"><input type=search class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/docs/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Workshop</a></li><ul><li class="collapse show" id=docs><a class="td-sidebar-link td-sidebar-link__page" id=m-docssessionsschedule href=/docs/sessions/schedule/>Schedule</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docsoverviewpeople href=/docs/overview/people/>People</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions01-baby-steps href=/docs/sessions/01-baby-steps/>01. Baby Steps</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions02-behind-scenes href=/docs/sessions/02-behind-scenes/>02. Behind the Scenes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions03-debugging href=/docs/sessions/03-debugging/>03. Debugging in Unikraft</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions04-complex-applications href=/docs/sessions/04-complex-applications/>04. Complex Applications</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions05-contributing-to-unikraft href=/docs/sessions/05-contributing-to-unikraft/>05. Contributing to Unikraft</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions06-testing-unikraft href=/docs/sessions/06-testing-unikraft/>06. Testing Unikraft</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions07-syscall-shim href=/docs/sessions/07-syscall-shim/>07. Syscall Shim</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-docssessions08-basic-app-porting href=/docs/sessions/08-basic-app-porting/>08. Basic App Porting</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions09-advanced-app-porting href=/docs/sessions/09-advanced-app-porting/>09. Advanced App Porting</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docssessions10-high-performance href=/docs/sessions/10-high-performance/>10. High Performance</a></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/unikraft/summer-of-code-2021/edit/master/content/en/docs/sessions/08-basic-app-porting/index.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/unikraft/summer-of-code-2021/new/master/content/en/docs/sessions/08-basic-app-porting/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/unikraft/summer-of-code-2021/issues/new?title=Session%2008:%20Basic%20App%20Porting" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/unikraft/unikraft/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=/docs/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><nav id=TableOfContents><ul><li><a href=#reminders>Reminders</a><ul><li><a href=#configuring-building-and-running-unikraft>Configuring, Building and Running Unikraft</a></li></ul></li><li><a href=#overview>Overview</a><ul><li><a href=#the-unikraft-build-lifecycle>The Unikraft Build Lifecycle</a></li><li><a href=#identifying-a-candidate-application>Identifying a Candidate Application</a></li><li><a href=#starting-with-a-linux-user-space-build>Starting with a Linux User Space Build</a></li><li><a href=#compiling-the-application-from-source>Compiling the Application from Source</a></li><li><a href=#setting-up-your-workspace>Setting up Your Workspace</a></li><li><a href=#creating-a-boilerplate-microlibrary-for-your-application>Creating a Boilerplate Microlibrary for Your Application</a></li><li><a href=#using-your-library-in-a-unikraft-unikernel-application>Using Your Library in a Unikraft Unikernel Application</a></li><li><a href=#providing-build-files>Providing Build Files</a></li><li><a href=#invoking-the-applications-main-method>Invoking the Application&rsquo;s <code>main</code> Method</a></li><li><a href=#patching-the-application>Patching the Application</a></li></ul></li><li><a href=#work-items>Work Items</a><ul><li><a href=#support-files>Support Files</a></li><li><a href=#01-port-libfortune-to-unikraft>01. Port <code>libfortune</code> to Unikraft</a></li><li><a href=#02-add-fortunes-to-unikrafts-boot-sequence>02. Add Fortunes to Unikraft&rsquo;s Boot Sequence</a></li><li><a href=#03-create-a-patch-to-introduce-a-new-fortune>03. Create a Patch to Introduce a New Fortune</a></li><li><a href=#04-give-us-feedback>04. Give Us Feedback</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=/docs/>Workshop</a></li><li class="breadcrumb-item active" aria-current=page><a href=/docs/sessions/08-basic-app-porting/>08. Basic App Porting</a></li></ol></nav><div class=td-content><h1>Session 08: Basic App Porting</h1><h2 id=reminders>Reminders</h2><h3 id=configuring-building-and-running-unikraft>Configuring, Building and Running Unikraft</h3><p>At this stage, you should be familiar with the steps of configuring, building and running any application within Unikraft and know the main parts of the architecture.
Below you can see a list of the commands you have used so far.</p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td><code>kraft list</code></td><td>Get a list of all components that are available for use with kraft</td></tr><tr><td><code>kraft up -t &lt;appname> &lt;your_appname></code></td><td>Download, configure and build existing components into unikernel images</td></tr><tr><td><code>kraft run</code></td><td>Run resulting unikernel image</td></tr><tr><td><code>kraft init -t &lt;appname></code></td><td>Initialize the application</td></tr><tr><td><code>kraft configure</code></td><td>Configure platform and architecture (interactive)</td></tr><tr><td><code>kraft configure -p &lt;plat> -m &lt;arch></code></td><td>Configure platform and architecture (non-interactive)</td></tr><tr><td><code>kraft build</code></td><td>Build the application</td></tr><tr><td><code>kraft clean</code></td><td>Clean the application</td></tr><tr><td><code>kraft clean -p</code></td><td>Clean the application, fully remove the <code>build/</code> folder</td></tr><tr><td><code>make clean</code></td><td>Clean the application</td></tr><tr><td><code>make properclean</code></td><td>Clean the application, fully remove the <code>build/</code> folder</td></tr><tr><td><code>make distclean</code></td><td>Clean the application, also remove <code>.config</code></td></tr><tr><td><code>make menuconfig</code></td><td>Configure application through the main menu</td></tr><tr><td><code>make</code></td><td>Build configured application (in <code>.config</code>)</td></tr><tr><td><code>qemu-guest -k &lt;kernel_image></code></td><td>Start the unikernel</td></tr><tr><td><code>qemu-guest -k &lt;kernel_image> -e &lt;directory></code></td><td>Start the unikernel with a filesystem mapping of <code>fs0</code> id from <code>&lt;directory></code></td></tr><tr><td><code>qemu-guest -k &lt;kernel_image> -g &lt;port> -P</code></td><td>Start the unikernel in debug mode, with GDB server on port <code>&lt;port></code></td></tr></tbody></table><h2 id=overview>Overview</h2><p>In previous sessions, you have learnt how to retrieve, configure and build applications which are already supported by Unikraft.
The applications which are supported by Unikraft are located on <a href=https://github.com/unikraft>Unikraft&rsquo;s Github organization</a> and are prefixed with <code>app-</code> (known colloquially as <em>app repos</em> or <code>app-*</code> as <em>app star repos</em>).
Alternatively, when you have used the Unikraft companion command-line client <a href=https://github.com/unikraft/kraft><code>kraft</code></a>, you can view these supported applications by running:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft list add https://github.com/unikraft/app-*
$ kraft list update
$ kraft list --apps
</code></pre></div><p>In this session, we dive into the ways in which you can bring an application which does not already exist within the Unikraft ecosystem.
You wish to make a traditional Linux user space application (which you have access to its source code) to run using Unikraft and to be listed in the command above, and, of course, be run as a single, specialized unikernel.
This tutorial shows you exactly how to do this.</p><h3 id=the-unikraft-build-lifecycle>The Unikraft Build Lifecycle</h3><p>The lifecycle of the construction of a Unikraft unikernel includes several distinct steps:</p><p style=text-align:center><img src=/docs/sessions/08-basic-app-porting/unikraft-overview.svg style=max-width:700px;display:block;margin:auto alt="Diagram of the overview of the Unikraft Build Process">
<strong style=margin-top:20px;display:inline-block>Overview of the Unikraft build process.</strong></p><ol><li>Configuring the Unikraft unikernel application with compile-time options;</li><li>Fetching the remote &ldquo;origin&rdquo; code of libraries;</li><li>Preparing the remote &ldquo;origin&rdquo; code of libraries;</li><li>Compiling the libraries and the core Unikraft code; and,</li><li>Finally, linking a final unikernel executable binary together.</li></ol><p>The above steps are displayed in the diagram.
The Unikraft unikernel targets a specific platform and hardware architecture, which are set during the configuration step of the lifecycle.</p><p>The steps in the lifecycle above are discussed in this tutorial in greater depth.
Particularly, we cover <code>fetch</code>ing, <code>prepare</code>ing and compiling (<code>build</code>ing) &ldquo;external&rdquo; code which is to be used as a Unikraft unikernel application (or library for that matter).</p><h3 id=identifying-a-candidate-application>Identifying a Candidate Application</h3><p>The scope of this tutorial only covers how to bring an application to Unikraft &ldquo;from first principles&rdquo;;
that is, before you use Unikraft, you can access the source files of the application and compile the application natively for Linux user space.
You wish to compile this application against the Unikraft core and any auxiliary necessary third-party libraries in order to make it a unikernel.
Classic examples of these types of applications are open-source ones, such as NGINX, Redis, etc.
Of course, you can work with code which is not open-source, but again, you must be able to access the source files and the build system before you can begin.</p><p>For the sake of simplicity, this tutorial will only be targeting applications which are C/C++-based.
Unikraft supports other compile-time languages, such as Golang, Rust and WASM.
However, the scope of this tutorial only follows an example with a C/++-based program.
Many of the principles in this tutorial, however, can be applied in the same way for said languages, with a bit of context-specific work.
Namely, this may include additional build rules for target files, using specific compilers and linkers, etc.</p><p>It is worth noting that we are only targeting compile-time applications in this tutorial.
Applications written a runtime language, such as Python or Lua, require an interpreter which must be brought to Unikraft first.
There are already lots of these high-level languages supported by Unikraft.
If you wish to run an application written in such a language, please check out the list of available applications.
However, if the language you wish to run is interpreted and not yet available on Unikraft, porting the interpreter would be in the scope of this tutorial, as the steps here would cover the ones needed to bring the interpreter, which is a program after all, as a Unikraft unikernel application.</p><p><strong>Note:</strong> In the case of higher-level languages which are interpreted, you do not need to follow this tutorial.
Instead, simply mount the application code with the relevant Unikernel binary.
For example, mounting a directory with python code to the python Unikraft unikernel.
Please review <a href=/docs/sessions/04-complex-applications/index.md>Session 04: Complex Applications</a> for more information on this topic.</p><h3 id=starting-with-a-linux-user-space-build>Starting with a Linux User Space Build</h3><p>For the remainder of this tutorial, we will be targeting the network utility program <a href=https://github.com/esnet/iperf><code>iperf3</code></a> as our application example we wish to bring to Unikraft.
<code>iperf3</code> is a benchmarking tool, and is used to determine the bandwidth between a client and server.
It makes for an excellent application to be run as a Unikernel because:</p><ul><li>It can run as a &ldquo;server-type&rdquo; application, receiving and processing requests for clients;</li><li>It is a standalone tool which does one thing;</li><li>It&rsquo;s <a href=https://www.gnu.org/software/make/>GNU Make</a> and C-based; and,</li><li>It&rsquo;s quite useful :)</li></ul><p>Bringing an application to Unikraft will involve understanding some of the way in which the application works, especially how it is built.
Usually during the porting process we also end up diving through the source code, and in the worst-case scenario, have to make a change to it.
More on this is covered <a href=#patching-the-application>later in this tutorial</a>.</p><p>We start by simply trying to follow the steps to compile the application from source.</p><h3 id=compiling-the-application-from-source>Compiling the Application from Source</h3><p>The <a href=https://github.com/esnet/iperf/blob/master/README.md><code>README</code></a> for the <code>iperf3</code> program has relatively simple build instructions, and uses GNU Make which is a first good sign.
Unikraft uses GNU Make to handle its internal builds and so when we see an application using Make, it makes porting a little easier.
For non-Make type build systems, such as CMake, Bazel, etc., it is still possible to bring this application to Unikraft, but the flags, files, and compile-time options, etc. will have to be considered with more care as they do not necessarily align in the same ways.
It is still possible to bring an application using an alternative build system, but you must closely follow how the program is built in order to bring it to Unikraft.</p><p>Let&rsquo;s walk through the build process of <code>iperf3</code> from its <code>README</code>:</p><ol><li><p>First we obtain the source code of the application:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ git clone https://github.com/esnet/iperf.git
</code></pre></div></li><li><p>Then, we are asked to configure and build the application:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ./iperf
$ ./configure<span style=color:#000;font-weight:700>;</span>
$ make
</code></pre></div></li></ol><p>If this has worked for you, your terminal will be greeted with several pieces of useful information:</p><ol><li><p>The first thing we did was run <code>./configure</code>: an auto-generated utility program part of the <a href=https://www.gnu.org/software/automake/><code>automake</code></a> build system.
Essentially, it checks the compatibility of your system and the program in question.
If everything went well, it will tell us information about what it checked and what was available.
Usually this &ldquo;<code>./configure</code>"-type program will raise any issues when it finds something missing.
One of the things it is checking is whether you have relevant shared libraries (e.g. <code>.so</code> files) installed on your system which are necessary for the application to run.
The application will be dynamically linked to these shared libraries and they will be referenced at runtime in a traditional Linux user space manner.
If something is missing, usually you must use your Linux-distro&rsquo;s package manager to install this dependency, such as via <code>apt-get</code>.</p><p>The <code>./configure</code> program also comes with a useful <code>--help</code> page where we can learn about which features we would like to turn on and off before the build.
It&rsquo;s useful to study this page and see what is available, as these can later become build options (see <a href=#02-add-fortunes-to-unikrafts-boot-sequence>exercise 2</a>) for the application when it is brought to the Unikraft ecosystem. The only thing to notice for the case of <code>iperf3</code> is that it uses <a href=https://www.openssl.org>OpenSSL</a>.
<a href=https://github.com/unikraft/lib-openssl>Unikraft already has a port of OpenSSL</a>, which means we do not have to port this before starting.
<strong>If, however, there are library dependencies for the target application which do not exist within the Unikraft ecosystem, then these library dependencies will need to be ported first before continuing.</strong>
The remainder of this tutorial also applies to porting libraries to Unikraft.</p></li><li><p>When we next run <code>make</code> in the sequence above, we can see the intermediate object files which are compiled during the compilation process before <code>iperf3</code> is finally linked together to form a final Linux user space binary application.
It can be useful to note these files down, as we will be compiling these files with respect to Unikraft&rsquo;s build system.</p></li></ol><p>You have now built <code>iperf3</code> for Linux user space and we have walked through the build process for the application itself.
In the next section, we prepare ourselves to bring this application to Unikraft.</p><h3 id=setting-up-your-workspace>Setting up Your Workspace</h3><p>Applications which are brought to Unikraft are actually libraries.
Everything in Unikraft is &ldquo;libracized&rdquo;, so it is no surprise to find out that even applications are a form of library: they are a single component which interact with other components; have their own options and build files; and, interact in the same ways in which other libraries interact with each other.
The &ldquo;main&rdquo; difference between actual libraries and applications, is that we later invoke the application&rsquo;s <code>main</code> method.
The different ways to do this are <a href=#invoking-the-applications-main-method>covered later in this tutorial</a>.</p><h3 id=creating-a-boilerplate-microlibrary-for-your-application>Creating a Boilerplate Microlibrary for Your Application</h3><p>To get started, we must create a new library for our application.
The premise here is that we are going to &ldquo;wrap&rdquo; or &ldquo;decorate&rdquo; the source code of <code>iperf3</code> with the <em>lingua franca</em> of Unikraft&rsquo;s build system.
That is, when we eventually build the application, the Unikraft build system will understand where to get the source code files, which ones to compile and how, with respect to the rest of Unikraft&rsquo;s internals and other dependencies.</p><p>Let&rsquo;s first start by initializing a working environment for ourselves:</p><ol><li><p>Let&rsquo;s create a workspace with a typical Unikraft structure using <code>kraft</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ~/workspace
$ <span style=color:#204a87>export</span> <span style=color:#000>UK_WORKDIR</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span><span style=color:#204a87>pwd</span><span style=color:#204a87;font-weight:700>)</span>
$ kraft list update
$ kraft list pull unikraft@staging
</code></pre></div><p>This will generate the necessary directory structure to build a new Unikraft application, and will also download the latest <code>staging</code> branch of Unikraft&rsquo;s core.
When we list the directories, we should get something like this:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tree -L <span style=color:#0000cf;font-weight:700>1</span>
</code></pre></div><pre><code>.
├── apps
├── archs
├── libs
├── plats
└── unikraft

5 directories, 0 files
</code></pre></li><li><p>Let&rsquo;s now create a library for <code>iperf3</code>.
We can use <code>kraft</code> to initialize some boilerplate for us too.
To do this, we must first retrieve some information about the program itself.
First, we need to identify the latest version number of <code>iperf3</code>.
GitHub tells us (as of the time of writing this tutorial) that this is <code>3.10.1</code>.</p><p>Unikraft relies on the ability to download the source code of the &ldquo;origin&rdquo; code which is about to be compiled.
Usually these are tarballs or zips.
Ideally, we want to have a version number in the URL so we can safely know the version being downloaded.
However, if the source code is on GitHub, which it is in the case of <code>iperf3</code>, then <code>kraft</code> can figure this out for us.</p><p>We can now use <code>kraft</code> to initialize a template library for us:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ~/workspace/libs
$ kraft lib init <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>   --no-prompt <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>   --author-name <span style=color:#4e9a06>&#34;Your Name&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>   --author-email <span style=color:#4e9a06>&#34;your@email.com&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>   --version 3.10.1 <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>   --origin https://github.com/esnet/iperf <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>   iperf3
</code></pre></div><p><code>kraft</code> will have now generated a new Git repository in <code>~/workspace/libs/iperf3</code> which contains some of the necessary files used to create an external library.
It has also checked out the repository with a default branch of <code>staging</code> and created a blank (empty) commit as the base of the repository.
This is standard practice for Unikraft repositories.</p><p><strong>Note:</strong> Our new library is called <code>libiperf3</code> to Unikraft.
The last argument of <code>kraft lib init</code> will simply prepend <code>lib</code> to whatever string name you give it.
If you are porting a library which is called <code>libsomething</code>, still pass the full name to <code>kraft</code>, it will replace instances of <code>liblibsomething</code> with <code>libsomething</code> during the initialization of the project where appropriate.</p></li><li><p>The next step is to register this library with <code>kraft</code> such that we can use it and manipulate it with the <code>kraft</code> toolchain. To do this, simply add the path of the newly initialized library like so:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft list add ~/workspace/libs/iperf3
</code></pre></div><p>This will modify your <code>.kraftrc</code> file with a new local library.
When you have added this library directory, run the update command so that <code>kraft</code> can realize it:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft list update
</code></pre></div></li><li><p>You should now be able to start using this boilerplate library with Unikraft and <code>kraft</code>.
To view basic information about the library and to confirm everything has worked, you can run:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft list show iperf3
</code></pre></div></li></ol><h3 id=using-your-library-in-a-unikraft-unikernel-application>Using Your Library in a Unikraft Unikernel Application</h3><p>Now that we have a library set up in <code>iperf3</code>&rsquo;s name, located at <code>~/workspace/libs/iperf3</code>, we should immediately start using it so that we can start the porting effort.</p><p>To do this, we create a parallel application which uses both the library we are porting and the Unikraft core source code.</p><ol><li><p>First start by creating a new application structure, which we can do by initializing a blank project:</p><pre><code>$ cd ~/workspace/apps
$ kraft init iperf3
</code></pre></li><li><p>We will now have a &ldquo;empty&rdquo; initialized project;
you&rsquo;ll find boilerplate in this directory, including a <code>kraft.yaml</code> file which will look something like this:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ~/workspace/apps/iperf3
$ cat kraft.yaml
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#204a87;font-weight:700>specification</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;0.5&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>unikraft</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>staging</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>targets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>   </span>- <span style=color:#204a87;font-weight:700>architecture</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>x86_84</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>     </span><span style=color:#204a87;font-weight:700>platform</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>kvm</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div></li><li><p>After setting up your application project, we should add the new library we are working on to the application.
This is done via:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft lib add iperf3@staging
</code></pre></div><p><strong>Note:</strong> Remember that the default branch of the library is <code>staging</code> from the <code>kraft lib init</code> command used above.
If you change branch or use an alternative <code>--initial-branch</code>, set it in this step.</p><p>This command will update your <code>kraft.yaml</code> file:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=color:navy;font-weight:700>diff --git a/kraft.yaml b/kraft.yaml
</span><span style=color:navy;font-weight:700>index 33696bb..c14e480 100644
</span><span style=color:navy;font-weight:700></span><span style=color:#a40000>--- a/kraft.yaml
</span><span style=color:#a40000></span><span style=color:#00a000>+++ b/kraft.yaml
</span><span style=color:#00a000></span><span style=color:purple;font-weight:700>@@ -6,3 +6,6 @@ unikraft:
</span><span style=color:purple;font-weight:700></span>targets:
   - architecture: x86_64
     platform: kvm
<span style=color:#00a000>+libraries:
</span><span style=color:#00a000>+  iperf3:
</span><span style=color:#00a000>+    version: staging
</span></code></pre></div></li><li><p>We are ready to configure the application to use the library.
It should be possible to now see the boilerplate <code>iperf3</code> library within the <a href=https://en.wikipedia.org/wiki/Menuconfig><code>menuconfig</code></a> system by running:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft menuconfig
</code></pre></div><p>within the application folder.
However, it will also be selected automatically since it is in the <code>kraft.yaml</code> file now if you run the configure step:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft configure
</code></pre></div><p>By default, the application targets <code>kvm</code> on <code>x86_64</code>.
Adjust appropriately for your use case either by updating the <code>kraft.yaml</code> file or by setting it the <code>menuconfig</code>.</p></li></ol><p>In the next section, we study the necessary files in the workspace and how we can modify them to bring <code>iperf3</code> into life with Unikraft.</p><h3 id=providing-build-files>Providing Build Files</h3><p>Now we have everything set up.
We can start an iterative process of building the target unikernel with the application.
This process is usually very iterative because it requires building the unikernel step-by-step, including new files to the build, making adjustments, and re-building, etc.</p><ol><li><p>The first thing we must do before we start is to check that <code>fetch</code>ing the remote code for <code>iperf3</code> is possible.
Let&rsquo;s try and do this by running in our application workspace:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ~/workspace/apps/iperf3
$ kraft fetch
</code></pre></div><p>If this is successful, we should see it download the remote zip file and we should see it saved within our Unikraft application&rsquo;s <code>build/</code>.
The directory with the extracted contents should be located at:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ls -lsh build/libiperf3/origin/iperf-3.10.1/
</code></pre></div><pre><code>total 988K
 12K -rw-r--r-- 1 root root 9.3K Jun  2 22:29 INSTALL
 12K -rw-r--r-- 1 root root  12K Jun  2 22:29 LICENSE
4.0K -rw-r--r-- 1 root root   23 Jun  2 22:29 Makefile.am
 28K -rw-r--r-- 1 root root  26K Jun  2 22:29 Makefile.in
8.0K -rw-r--r-- 1 root root 6.5K Jun  2 22:29 README.md
 32K -rw-r--r-- 1 root root  31K Jun  2 22:29 RELNOTES.md
368K -rw-r--r-- 1 root root 365K Jun  2 22:29 aclocal.m4
4.0K -rwxr-xr-x 1 root root 2.0K Jun  2 22:29 bootstrap.sh
   0 drwxr-xr-x 2 root root  260 Jun  2 22:29 config
496K -rwxr-xr-x 1 root root 494K Jun  2 22:29 configure
 12K -rw-r--r-- 1 root root  11K Jun  2 22:29 configure.ac
   0 drwxr-xr-x 2 root root  140 Jun  2 22:29 contrib
   0 drwxr-xr-x 3 root root  280 Jun  2 22:29 docs
   0 drwxr-xr-x 2 root root  120 Jun  2 22:29 examples
4.0K -rw-r--r-- 1 root root 3.0K Jun  2 22:29 iperf3.spec.in
4.0K -rwxr-xr-x 1 root root 1.2K Jun  2 22:29 make_release
   0 drwxr-xr-x 2 root root  980 Jun  2 22:29 src
4.0K -rwxr-xr-x 1 root root 1.9K Jun  2 22:29 test_commands.sh
</code></pre><p>If this has not worked, you must fiddle with the preamble at the top of the library&rsquo;s <code>Makefile.uk</code> to ensure that correct paths are being set.
Remove the <code>build/</code> directory and try <code>fetch</code>ing again.</p></li><li><p>Now that we can fetch the remote sources, <code>cd</code> into this directory and perform the <code>./configure</code> step as above.
This will do two things for us.
The first is that it will generate (and this is very common for C-based programs) a <code>config.h</code> file.
This file is a list of macro flags which are used to include or exclude lines of code by the preprocessor.
If the program has one of these, we need it.</p><p><code>iperf3</code> has an <code>iperf_config.h</code> file, so let&rsquo;s copy this file into our Unikraft port of the application.
Make an <code>include/</code> directory in the library&rsquo;s repository and copy the file:</p><pre><code>$ mkdir ~/workspace/libs/iperf3/include
$ cp build/libiperf3/origin/iperf-3.10.1/src/iperf_config.h ~/workspace/libs/iperf3/include
</code></pre><p>Let&rsquo;s indicate in the <code>Makefile.uk</code> of the Unikraft library for <code>iperf3</code> that
this directory exists:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>LIBIPERF3_CINCLUDES-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> -I<span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_BASE<span style=color:#204a87;font-weight:700>)</span>/include
</code></pre></div><p>We&rsquo;ll come back to <code>iperf_config.h</code>: likely it needs edits from us to turn features on or off depending on availability or applicability based on the unikernel-context.
We can also wrap build options here (see <a href=#02-add-fortunes-to-unikrafts-boot-sequence>exercise 2</a>).</p></li><li><p>Next, let&rsquo;s run <code>make</code> with a special flag:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> build/libiperf3/origin/iperf-3.10.1/
$ make -n
</code></pre></div><p>This flag, <code>-n</code>, has just shown us what <code>make</code> will run; the full commands for <code>gcc</code> including flags.
What&rsquo;s interesting here is any line which start with:</p><pre><code>$ echo &quot;  CC      &quot;
</code></pre><p>These are lines which invoke <code>gcc</code>.
We can gather a few pieces of information here, namely the flags and list of files we need to make <code>iperf3</code> a reality.</p></li><li><p>Let&rsquo;s start by setting global flags for <code>iperf3</code>.
The rule of thumb here is that we copy the flags which are used in all invocations of <code>gcc</code> and place them within the <code>Makefile.uk</code>.
We should ignore flags to do with optimization, PIE, shared libraries and standard libraries as Unikraft has global build options for these.
Flags which are usually interesting are to do with suppressing warnings, e.g. things that start with <code>-W</code>, and are application-specific.
There doesn&rsquo;t seem to be anything immediately obvious for <code>iperf3</code>.
However, in a later step, we&rsquo;ll find out that we can set some flags.
If you do have flags which are immediately obvious, you set them like so in the library port&rsquo;s <code>Makefile.uk</code>, for example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>LIBIPERF3_CFLAGS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> -Wno-unused-parameter
</code></pre></div></li><li><p>We have a full list of files for <code>iperf3</code> from step 3.
We can add them as known source files like so to the Unikraft port of <code>iperf3</code>&rsquo;s <code>Makefile.uk</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>LIBIPERF3_SRCS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_SRC<span style=color:#204a87;font-weight:700>)</span>/main.c
<span style=color:#000>LIBIPERF3_SRCS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_SRC<span style=color:#204a87;font-weight:700>)</span>/cjson.c
<span style=color:#000>LIBIPERF3_SRCS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_SRC<span style=color:#204a87;font-weight:700>)</span>/iperf_api.c
<span style=color:#000>LIBIPERF3_SRCS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_SRC<span style=color:#204a87;font-weight:700>)</span>/iperf_error.c
<span style=color:#a40000>...</span>
</code></pre></div><p><strong>Note:</strong> The path in the variable <code>LIBIPERF3_SRC</code> may need to be adjusted from the boilerplate code to match the layout of the application you are porting.</p><p><strong>Tip:</strong> It&rsquo;s best to add these files iteratively, i.e. one-by-one, and attempt the compilation process (step 5) in between adding all files.
This will show you errors about what&rsquo;s missing and you can accurately determine which files are truly necessary for the build.
In addition to this, we can also find intermittent errors which will be the result of incompatibilities between Unikraft and the application in question (covered in the next section on making patches).</p></li><li><p>Now that we have added all the source files, let&rsquo;s try and build the application! This step, again, usually occurs iteratively along with the previous step of adding a new file one-by-one.
Because the application has been <code>configure</code>d and we have <code>fetch</code>ed the contents, we can simply try running the build in the Unikraft application directory:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ~/workspace/apps/iperf3
$ kraft build
</code></pre></div></li><li><p>(Optional) This step occurs less frequently, but is still useful to discuss in the context of porting an application to Unikraft.
Remember in <a href=#the-unikraft-build-lifecycle>the Unikraft build lifecycle</a> that there is a step which occurs between fetching the remote origin code and compiling it. This step (3), known as <code>prepare</code>, is used to make modifications to the origin code before it is compiled.
This may be useful for applications which have complex build systems or auxiliary files which need to be created or modified before they are built.
Examples for <code>prepare</code>ing include:</p><ul><li>Running scripts which generate new source files from templates;</li><li>Compiling files preemptively before Unikraft starts <code>build</code>ing source files;</li><li>Checking for additional tools or building additional tools which are required to build the library; and,</li><li>Advanced patching techniques to the source files of the library which make changes to it in a non-standard way.</li></ul><p>Preparation is done by adding Make targets to the <code>UK_PREPARE</code> variable:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>UK_PREPARE</span> <span style=color:#ce5c00;font-weight:700>+=</span> mytarget
</code></pre></div><p>Checking whether the library has been <code>prepare</code>d or adding a target which requires preparation before it can be executed is as simple as checking whether the following target exists:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>LIBIPERF</span>3<span style=color:#000>_BUILD</span><span style=color:#204a87;font-weight:700>)</span><span style=color:#a40000>/.patched</span>
</code></pre></div><p>The <code>prepare</code> step is called naturally because of this target.
However, it can be called separately from <code>kraft</code> via:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kraft prepare
</code></pre></div></li></ol><p>The steps outlined above helped us begin the process of porting a simple application to Unikraft.
It covers the major steps involved in the process of porting &ldquo;from first principles,&rdquo; including addressing all the steps in the construction lifecycle of Unikraft unikernels.</p><p>There are occasional caveats to this process, however.
This is to do with context of the &ldquo;unikernel model,&rdquo; that is, single-purpose OSes with a single address space, acting in a single process without context switches or costly syscalls.
Applications developed for Linux user space make a number of assumptions about its runtime, for example:</p><ul><li>That all syscalls are available (which is not the case for Unikraft, although there is significant work being done to bring more syscalls to Unikraft);</li><li>That the filesystem is complete;</li><li>That P in POSIX is <em>not</em> silent: Unfortunately it is and Unix-type systems do not always adhere to standards and make their own assumptions.
For example, oftentimes there are differences between Linux and BSD-type OSes which need to be accounted for; and,</li><li>That all features are necessary.</li></ul><p>In the next section we address how we can make changes to the application before it is compiled by the Unikraft build system in order to address the points above.</p><h3 id=invoking-the-applications-main-method>Invoking the Application&rsquo;s <code>main</code> Method</h3><p>Traditionally, and by explicit design, Linux user space code invokes a <code>main</code> method (or symbol) for the start-of-execution of application logic.
Unikraft is similar and invokes a <a href=https://gcc.gnu.org/onlinedocs/gcc-4.3.5/gcc/Function-Attributes.html><code>weak</code>-ly attributed symbol</a> for <code>main</code> in <a href=https://github.com/unikraft/unikraft/blob/staging/lib/ukboot/boot.c#L75>its main thread</a>.
This is done so that it can be easily overwritten so as to invoke true application-level functionality.
Without any <code>main</code> method, the unikernel will simply boot and exit.</p><p>All applications must implement the following standard prototype for <code>main</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>/* Definition 1 */</span>
<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>__</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>attribute</span> <span style=color:#000>unused</span><span style=color:#000;font-weight:700>))</span><span style=color:#000>__</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>argc</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>__</span><span style=color:#000;font-weight:700>((</span><span style=color:#000>attribute</span> <span style=color:#000>unused</span><span style=color:#000;font-weight:700>))</span><span style=color:#000>__</span> <span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>argv</span><span style=color:#000;font-weight:700>[]);</span>
<span style=color:#8f5902;font-style:italic>/* Definition 2 */</span>
<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>argc</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>argv</span><span style=color:#000;font-weight:700>[]);</span>
<span style=color:#8f5902;font-style:italic>/* Definition 3 */</span>
<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>void</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol><li>The first definition simply indicates that the parameters may be unused within the function body, i.e. no command-line arguments <em>may</em> be passed as the application makes no use of them.</li><li>The second is probably more familiar, with explicit use of command-line arguments.</li><li>Lastly, the third definition explicitly forgoes the use command-line arguments.</li></ol><p>There are two ways to invoke the functionality of the application being ported to Unikraft.</p><h4 id=do-nothing-and-let-main-be-invoked-automatically>Do Nothing and Let <code>main</code> be Invoked Automatically</h4><p>If the application has a relatively simple <code>main</code> method with one of the prototypes defined above, we could simply leave it and it will be automatically invoked since it represents the only symbol named <code>main</code> in the final binary.
This requires the file to be recognised and compiled however, which is done by simply adding the file with the <code>main</code> method to the Unikraft port of the library&rsquo;s <code>Makefile.uk</code> as a new <code>_SRC-y</code> entry.</p><p>For <code>iperf3</code>, this is done by compiling in <code>main.c</code> which contains the <code>main</code> method:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>LIBIPERF3_SRCS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_SRC<span style=color:#204a87;font-weight:700>)</span>/main.c
</code></pre></div><h4 id=manually-invoking-main-with-glue-code>Manually Invoking <code>main</code> with Glue Code</h4><p>To increase extensibility or adapt the application to the context of a unikernel, we can perform a small trick to conditionally invoke the <code>main</code> method of the application as a compile-time option.
This is useful in different cases, for instance:</p><ul><li><p>In some cases where the <code>main</code> method for the application may be relatively complex and includes boilerplate code which is not applicable to the use case of a unikernel, it is possible invoke the relevant application-level functionality by calling another method within the application&rsquo;s source code (this is true in the case of, for example, the <a href=https://github.com/unikraft/lib-python3/blob/staging/main.c>Unikraft port of Python3</a>).</p></li><li><p>In other cases, we may wish to perform additional initialisation before the invocation of the application&rsquo;s <code>main</code> method (this is true in the case of, for example, the <a href=https://github.com/unikraft/lib-redis/blob/staging/main.c>Unikraft port of Redis</a>).</p></li><li><p>We wish to use the application as a library in the future for another application, and call APIs which it may expose.
In this case, we do not wish to invoke the <code>main</code> method as it will conflict with the other application&rsquo;s <code>main</code> method.</p></li></ul><p>In any case, we can rename the default <code>main</code> symbol in the application by using the <code>gcc</code> flag <a href=https://www.rapidtables.com/code/linux/gcc/gcc-d.html><code>-D</code></a> during the pre-processing of the file which contains the method. This flag allows us to define macros in-line, and we can simply introduce a macro which renames the <code>main</code> method to something else.</p><p>With <code>iperf3</code>, for example, we can rename the <code>main</code> method to <code>iperf3_main</code> by adding a new library-specific <code>_FLAGS-y</code> entry in <code>Makefile.uk</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>LIBIPERF3_IPERF3_FLAGS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> -Dmain<span style=color:#ce5c00;font-weight:700>=</span>iperf3_main
</code></pre></div><p>The resulting object file for <code>main.c</code> will no longer include a symbol named <code>main</code>.
At this point, when the final unikernel binary is linked, it will simply quit. We must now provide another <code>main</code> method.</p><p>To conditionally invoke the application&rsquo;s now renamed <code>main</code> method, it is common to provide a new KConfig in the Unikraft library representing the port of the application&rsquo;s <code>Config.uk</code> file, asking whether to &ldquo;provide the main method&rdquo;.
For example, with <code>iperf3</code>:</p><pre><code class=language-KConfig data-lang=KConfig>if LIBIPERF3
config LIBIPERF3_MAIN_FUNCTION
	bool &quot;Provide main function&quot;
	default n
endif
</code></pre><p>When this option is enabled, we can either:</p><ol><li><p>Disable the use of the <code>-D</code> flag as indicated above, conditionally in the <code>Makefile.uk</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#a40000>ifneq(</span><span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>CONFIG_LIBIPERF</span>3<span style=color:#000>_MAIN_FUNCTION</span><span style=color:#204a87;font-weight:700>)</span><span style=color:#a40000>,y)</span>
<span style=color:#000>LIBIPERF3_IPERF3_FLAGS-y</span> <span style=color:#ce5c00;font-weight:700>+=</span> -Dmain<span style=color:#ce5c00;font-weight:700>=</span>iperf3_main
<span style=color:#a40000>endif</span>
</code></pre></div></li><li><p>Or more commonly, introduce a conditional file which provides <code>main</code> and invokes the renamed <code>main</code> (now <code>iperf3_main</code>) method from the library, for example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#000>LIBIPERF3_SRCS-$(CONFIG_LIBIPERF3_MAIN_FUNCTION)</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_BASE<span style=color:#204a87;font-weight:700>)</span>/main.c<span style=color:#000;font-weight:700>|</span>unikraft
</code></pre></div><p>Notice how the filename is includes the suffix <code>|unikraft</code>.
This is used to simply rename the resulting object file, which will become <code>main.unikraft.io</code>.</p><p>The new <code>main.c</code> file as part of the library simply calls the renamed method:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>argc</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>argv</span><span style=color:#000;font-weight:700>[])</span>
<span style=color:#000;font-weight:700>{</span>
   <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>iperf3_main</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>argc</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>argv</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div></li></ol><h3 id=patching-the-application>Patching the Application</h3><p>Patching the application occasionally must occur to address incompatibilities with the context of a Linux user space application and that of the unikernel model.
It can also be used to introduce new features to the application, although this is more rare (although, <a href=https://github.com/unikraft/lib-newlib/blob/staging/patches/0010-enable-per-library-allocator-statistics.patch>here is an example</a>).</p><h4 id=identifying-a-change-to-the-application>Identifying a Change to the Application</h4><p>Identifying a change to the application which requires a patch is sometimes quite subtle.
The process usually occurs during <a href=#providing-build-files>steps 5 and 6 of providing build files</a> of the application or library in question.
During this process, we are expected to see compile-time and link-time errors from <code>gcc</code> as we add new files to the build and make fixes.</p><p>The <code>iperf3</code> application port to Unikraft has four patches in order to make it work.
Let&rsquo;s discuss them and what they mean.
The next section discusses how to create one of these patches.</p><ol><li><p><a href=https://github.com/lancs-net/lib-iperf3/blob/staging/patches/0001-Fix-duplicate-import-of-netinet-tcp.h.patch>The first patch</a> comes from an error which is thrown when compiling the <code>iperf_api.c</code> source file.
This file is 3rd to be compiled from the list of complete source files.
In this file, we are receiving a duplicate import of <code>&lt;netinent/tcp.h></code>, simply removing this import fixes it, so the patch addresses this issue.</p></li><li><p><a href=https://github.com/lancs-net/lib-iperf3/blob/staging/patches/0002-Disable-SO_SNDBUF-and-SO_RCVBUF-checks.patch>The second patch</a> comes as a result of <a href=https://github.com/lwip-tcpip/lwip/blob/b0e347158d8db640c6891f9f31f4e6d19dca200b/src/include/lwip/sockets.h#L220>missing functionality from LwIP</a>.
The issue was discovered once the application was fully ported and was able to boot and run.
When the initialization sequence was on-going between the client and server of <code>iperf3</code>, it would crash during this sequence because LwIP does not support setting this option.
A patch was created simply to remove setting this option.
(Note: this may not be the most sensible approach)</p></li><li><p><a href=https://github.com/lancs-net/lib-iperf3/blob/staging/patches/0003-Set-the-temp-path-to-the-root.patch>The third patch</a> arises from an assumption about the host environment and the difference between Linux user space and a unikernel.
With a traditional host OS, we have a filesystem populated with known paths, for example <code>/tmp</code>.
<code>iperf3</code> assumed this path exists, however, in the case of where no filesystem is provided to the unikernel during boot, which should be possible in some cases, the <code>iperf3</code> application would crash since <code>/tmp</code> does not exist beforehand.
The patch solves this by setting the temporary (ramfs) path to <code>/</code>.
An alternative solution is to make this path at boot.</p></li><li><p>Finally, <a href=https://github.com/lancs-net/lib-iperf3/blob/staging/patches/0004-Disable-use-of-mmap-and-replace-with-mmalloc-and-fr.patch>the fourth patch</a> is once again to do with missing functionality from Unikraft.
In this case, the syscalls <a href=https://linux.die.net/man/2/mmap><code>mmap</code></a> and <a href=https://linux.die.net/man/2/munmap><code>munmap</code></a> are missing.
In this case, <code>iperf3</code>, used <code>mmap</code> simply to statically allocate a region of memory.
The trick used here is to simply replace instances of <code>mmap</code> with <code>malloc</code> and instances of <code>munmap</code> with <code>free</code>.</p><p><strong>Note:</strong> At the time writing this tutorial, <a href=https://github.com/unikraft/unikraft/pull/247><code>mmap</code> and <code>munmap</code> are being actively worked on to be made available as syscalls in Unikraft</a>.</p></li></ol><p>The above patches represent example use cases where patches may be necessary to fix the application when bringing it to Unikraft.
The possibilities presented in this tutorial are non-exhaustive, so take care.</p><p>The next section discusses in detail how to create a patch for the target
application or library.</p><h4 id=preparing-a-patch-for-the-application>Preparing a Patch for the Application</h4><p>When a change is identified and is to be provided as a patch to the application or library during the compilation, it can be done using the procedure identified in this section.
Note that providing patches are an unfortunate workaround to the inherent differences between Linux user space applications and libraries and unikernels.</p><p><strong>Note:</strong> When patches are created, they are also version-specific.
As such, if you update the library or application&rsquo;s code (i.e. by updating, for example, the version number of <code>LIBIPER3_VERSION</code>), patches may no longer be apply-able and will then need to be updated accordingly.</p><p>To make a patch:</p><ol><li><p>First, ensure that the remote origin code has been downloaded to the application&rsquo;s <code>build/</code> folder:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> ~/workspace/apps/iperf3
$ kraft fetch
</code></pre></div></li><li><p>Once the source files have been downloaded, turn it into a Git repository and save everything to an initial commit, in the case of <code>iperf3</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#204a87>cd</span> build/libiperf3/origin/iperf-3.10.1
$ git init
$ git add .
$ git commit -m <span style=color:#4e9a06>&#34;Initial commit&#34;</span>
</code></pre></div><p>This will allow us to make changes to the source files and save those differences.</p></li><li><p>After making changes, create a Git commit, where you briefly describe the change you made and why.
This can be done through a number of successive steps, for example, as a result of having to make several changes to the application.</p></li><li><p>After your changes have been saved to the git log, export them as patches.
For example, if you have made one (<code>1</code>) patch only, export it like so:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git format-patch HEAD~1
</code></pre></div><p>This will save a new <code>.patch</code> file in the current directory; which should be the origin source files of <code>iperf3</code>.</p></li><li><p>The next step is to create a <code>patches/</code> folder within the Unikraft port of the library and to move the new <code>.patch</code> file into this folder:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir ~/workspace/libs/iperf3/patches
mv ~/workspace/apps/iperf3/build/libiperf3/origin/iperf-3.10.1/*.patch ~/workspace/libs/iperf3/patches
</code></pre></div></li><li><p>To register patches against Unikraft&rsquo;s build system such that they are applied before the compilation of all source files, simply indicate it in the library&rsquo;s <code>Makefile.uk</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Makefile data-lang=Makefile><span style=color:#8f5902;font-style:italic># Add or edit ~/workspace/libs/iperf3/Makefile.uk
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>LIBIPERF3_PATCHDIR</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>$(</span>LIBIPERF3_BASE<span style=color:#204a87;font-weight:700>)</span>/patches
</code></pre></div></li></ol><p>This concludes the necessary steps to port an application to Unikraft &ldquo;from first principles&rdquo;.</p><h2 id=work-items>Work Items</h2><h3 id=support-files>Support Files</h3><p>Session support files are available <a href=https://github.com/unikraft/summer-of-code-2021>in the repository</a>.
If you already cloned the repository, update it and enter the session directory:</p><pre><code>$ cd path/to/repository/clone

$ git pull --rebase

$ cd content/en/docs/sessions/08-basic-app-porting/

$ ls -F
index.md  sol/  unikraft-overview.svg  work/
</code></pre><p>If you haven&rsquo;t cloned the repository yet, clone it and enter the session directory:</p><pre><code>$ git clone https://github.com/unikraft/summer-of-code-2021

$ cd content/en/docs/sessions/08-basic-app-porting/

$ ls -F
ndex.md  sol/  unikraft-overview.svg  work/
</code></pre><h3 id=01-port-libfortune-to-unikraft>01. Port <code>libfortune</code> to Unikraft</h3><p>(Uni)kernel developers often seek guidance from elders, lost <code>man</code> pages, wizards, source code comments and occasionally swear by the reproducible environment. But the unfortunate truth is that &ldquo;bitshifts happen,&rdquo; and we cannot always <a href=https://www.ggbuddy.com/img/post/oymiswgv/midgvf/3245543291_ac5d471739d22f258621e4e7cbdcb98f_309e11564f795_m.jpg>leverage guidance from mysterious forces</a>.</p><p>A shared library called <a href=https://github.com/nderjung/libfortune><code>libfortune</code></a> can offer solace in such times, providing much needed guidance to those who find themselves in the position of requiring fast boot times and secure memory isolation of an application.
This library is no joke, it will save us all.</p><p>In this mission, if you choose to accept it, port <code>libfortune</code> to Unikraft using the steps in the tutorial above.
<code>libfortune</code> is a simple shared library and should also demonstrate how it is possible to build a library which can be used for both Linux user space as well as Unikraft with a little bit of glue.
If you are successful in porting this library, you should be able to run the <a href=https://github.com/unikraft/summer-of-code-2021/content/en/docs/sessions/08-basic-app-porting/work/01-app-fortune><code>app-fortune</code></a> located in this session&rsquo;s repository folder:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ git clone https://github.com/unikraft/summer-of-code-2021.git
$ <span style=color:#204a87>cd</span> summer-of-code-2021/content/en/docs/sessions/08-basic-app-porting/work/01-app-fortune
$ kraft configure
$ kraft build
$ kraft run
</code></pre></div><pre><code>[...]

SeaBIOS (version rel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org)
Booting from ROM...
Powered by
o.   .o       _ _               __ _
Oo   Oo  ___ (_) | __ __  __ _ ' _) :_
oO   oO ' _ `| | |/ /  _)' _` | |_|  _)
oOo oOO| | | | |   (| | | (_) |  _) :_
 OoOoO ._, ._:_:_,\_._,  .__,_:_, \___)
                   Tethys 0.5.0~825b115

&quot;It always seems impossible until it is done.&quot;
        -- Nelson Mandela
</code></pre><h3 id=02-add-fortunes-to-unikrafts-boot-sequence>02. Add Fortunes to Unikraft&rsquo;s Boot Sequence</h3><p>In this task, we are diving a little deeper into Unikraft&rsquo;s core and finding an opportunity to meddle with internal features which can prove handy for certain application contexts.
In this case, we are going to play with Unikraft&rsquo;s extensible boot sequence to provide fortunes during the boot of an application.
After word got out, we found that everybody wanted fortunes, right before the application started and <code>main()</code> was called.
This will provide the runtime of the unikernel with good fortune and save it from crashes.</p><p>Unikraft calls various &ldquo;constructor&rdquo; (<code>ctor</code>) and &ldquo;initialiser&rdquo; (<code>init</code>) methods during its boot sequence.
These constructors and initialisers are located in a static section of the final binary image, <code>ctortab</code> and <code>inittab</code>, respectively.
There are 7 entry points during the boot sequence:</p><table><thead><tr><th style=text-align:right>Order</th><th style=text-align:right>Level</th><th>Registering method</th><th>Type</th></tr></thead><tbody><tr><td style=text-align:right>1</td><td style=text-align:right>1</td><td><code>UK_CTOR_PRIO(fn, prio)</code></td><td><code>ctor</code></td></tr><tr><td style=text-align:right>2</td><td style=text-align:right>1</td><td><code>uk_early_initcall_prio(fn, prio)</code></td><td><code>init</code></td></tr><tr><td style=text-align:right>3</td><td style=text-align:right>2</td><td><code>uk_plat_initcall_prio(fn, prio)</code></td><td><code>init</code></td></tr><tr><td style=text-align:right>4</td><td style=text-align:right>3</td><td><code>uk_lib_initcall_prio(fn, prio)</code></td><td><code>init</code></td></tr><tr><td style=text-align:right>5</td><td style=text-align:right>4</td><td><code>uk_rootfs_initcall_prio(fn, prio)</code></td><td><code>init</code></td></tr><tr><td style=text-align:right>6</td><td style=text-align:right>5</td><td><code>uk_sys_initcall_prio(fn, prio)</code></td><td><code>init</code></td></tr><tr><td style=text-align:right>7</td><td style=text-align:right>6</td><td><code>uk_late_initcall_prio(fn, prio)</code></td><td><code>init</code></td></tr></tbody></table><p>New constructors and initialisers can be registered using the methods defined above at various levels (meaning they are called in that order) and at various priorities (between <code>0</code> and <code>9</code>); allowing the registration of numerous constructors or initialisers at the same level.
This allows application developers or library developers to correctly set up the unikernel by registering a constructor or initialiser at the right time or before or after others.</p><p>Initialisers have 6 different levels, allowing code to be injected before certain operations occur during the boot sequence.
This includes, in order: before and after the <code>plat</code>form drivers are initialised; before and after all <code>lib</code>raries are initialised; before and after all filesystems (<code>rootfs</code>) are initialised; and, before and after various &ldquo;<code>sys</code>tem&rdquo; methods are called.</p><p>The source code for this sequence is defined in <a href=https://github.com/unikraft/unikraft/blob/staging/lib/ukboot/boot.c><code>ukboot</code></a>.</p><p>In this task, add a new KConfig option to the Unikraft port of <code>libfortune</code> which allows you to enable or disable the ability to introduce a fortune during the boot sequence of a Unikernel.
Demonstrate the ability of using this library by building the Unikraft port of <code>libfortune</code> to the Unikraft port of <a href=https://github.com/unikraft/app-python3>python3</a> and show a fortune before the Unikraft banner.</p><h3 id=03-create-a-patch-to-introduce-a-new-fortune>03. Create a Patch to Introduce a New Fortune</h3><p>There is a well-known kernel quote, which should be introduced to this library as an Easter egg for unikernel users:</p><p>&ldquo;<a href=https://twitter.com/avsm/status/1265666433914191876>Kernel hacking: where the time to solve a problem is inversely proportional to the size of the resulting diff</a>&rdquo;</p><p>&ndash; Anil Madhavapeddy</p><p>Please add this quote to <code>libfortune</code> as a patch so it is only available when used with unikernels.</p><h3 id=04-give-us-feedback>04. Give Us Feedback</h3><p>We want to know how to make the next sessions better.
For this <a href=https://forms.gle/RY5sZbDqCXyAXH6v6>we need your feedback</a>!</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/unikraft/summer-of-code-2021/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/unikraft/summer-of-code-2021/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector('.feedback--answer-yes'),noButton=document.querySelector('.feedback--answer-no'),yesResponse=document.querySelector('.feedback--response-yes'),noResponse=document.querySelector('.feedback--response-no'),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=b=>{if(typeof ga!='function')return;const a={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:b};ga(a.command,a.hitType,a.category,a.action,a.label,a.value)};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(1)}),noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified August 31, 2021: <a href=https://github.com/unikraft/summer-of-code-2021/commit/09e3b47a9e82aec0caf7e6ba1e9732800b1813c7>Fix typos and missing dots (09e3b47)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel="noopener noreferrer" href=https://bit.ly/UnikraftDiscord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel="noopener noreferrer" href=https://twitter.com/UnikraftSDK><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/unikraft/unikraft><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=LinkedIn aria-label=LinkedIn><a class=text-white target=_blank rel="noopener noreferrer" href=https://linkedin.com/company/unikraft-sdk><i class="fab fa-linkedin"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 Unikraft and Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js integrity="sha256-XHS4cMaVOTGnBfOQpJx+TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin=anonymous></script></body></html>